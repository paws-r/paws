# This file is generated by make.paws. Please do not edit here.
#' @importFrom paws.common get_config new_operation new_request send_request
#' @include detective_service.R
NULL

#' Accepts an invitation for the member account to contribute data to a
#' behavior graph
#'
#' @description
#' Accepts an invitation for the member account to contribute data to a
#' behavior graph. This operation can only be called by an invited member
#' account.
#' 
#' The request provides the ARN of behavior graph.
#' 
#' The member account status in the graph must be `INVITED`.
#'
#' @usage
#' detective_accept_invitation(GraphArn)
#'
#' @param GraphArn &#91;required&#93; The ARN of the behavior graph that the member account is accepting the
#' invitation for.
#' 
#' The member account status in the behavior graph must be `INVITED`.
#'
#' @return
#' An empty list.
#'
#' @section Request syntax:
#' ```
#' svc$accept_invitation(
#'   GraphArn = "string"
#' )
#' ```
#'
#' @keywords internal
#'
#' @rdname detective_accept_invitation
detective_accept_invitation <- function(GraphArn) {
  op <- new_operation(
    name = "AcceptInvitation",
    http_method = "PUT",
    http_path = "/invitation",
    paginator = list()
  )
  input <- .detective$accept_invitation_input(GraphArn = GraphArn)
  output <- .detective$accept_invitation_output()
  config <- get_config()
  svc <- .detective$service(config)
  request <- new_request(svc, op, input, output)
  response <- send_request(request)
  return(response)
}
.detective$operations$accept_invitation <- detective_accept_invitation

#' Creates a new behavior graph for the calling account, and sets that
#' account as the master account
#'
#' @description
#' Creates a new behavior graph for the calling account, and sets that
#' account as the master account. This operation is called by the account
#' that is enabling Detective.
#' 
#' Before you try to enable Detective, make sure that your account has been
#' enrolled in Amazon GuardDuty for at least 48 hours. If you do not meet
#' this requirement, you cannot enable Detective. If you do meet the
#' GuardDuty prerequisite, then when you make the request to enable
#' Detective, it checks whether your data volume is within the Detective
#' quota. If it exceeds the quota, then you cannot enable Detective.
#' 
#' The operation also enables Detective for the calling account in the
#' currently selected Region. It returns the ARN of the new behavior graph.
#' 
#' [`create_graph`][detective_create_graph] triggers a process to create
#' the corresponding data tables for the new behavior graph.
#' 
#' An account can only be the master account for one behavior graph within
#' a Region. If the same account calls
#' [`create_graph`][detective_create_graph] with the same master account,
#' it always returns the same behavior graph ARN. It does not create a new
#' behavior graph.
#'
#' @usage
#' detective_create_graph()
#'

#'
#' @return
#' A list with the following syntax:
#' ```
#' list(
#'   GraphArn = "string"
#' )
#' ```
#'

#'
#' @keywords internal
#'
#' @rdname detective_create_graph
detective_create_graph <- function() {
  op <- new_operation(
    name = "CreateGraph",
    http_method = "POST",
    http_path = "/graph",
    paginator = list()
  )
  input <- .detective$create_graph_input()
  output <- .detective$create_graph_output()
  config <- get_config()
  svc <- .detective$service(config)
  request <- new_request(svc, op, input, output)
  response <- send_request(request)
  return(response)
}
.detective$operations$create_graph <- detective_create_graph

#' Sends a request to invite the specified AWS accounts to be member
#' accounts in the behavior graph
#'
#' @description
#' Sends a request to invite the specified AWS accounts to be member
#' accounts in the behavior graph. This operation can only be called by the
#' master account for a behavior graph.
#' 
#' [`create_members`][detective_create_members] verifies the accounts and
#' then sends invitations to the verified accounts.
#' 
#' The request provides the behavior graph ARN and the list of accounts to
#' invite.
#' 
#' The response separates the requested accounts into two lists:
#' 
#' -   The accounts that [`create_members`][detective_create_members] was
#'     able to start the verification for. This list includes member
#'     accounts that are being verified, that have passed verification and
#'     are being sent an invitation, and that have failed verification.
#' 
#' -   The accounts that [`create_members`][detective_create_members] was
#'     unable to process. This list includes accounts that were already
#'     invited to be member accounts in the behavior graph.
#'
#' @usage
#' detective_create_members(GraphArn, Message, Accounts)
#'
#' @param GraphArn &#91;required&#93; The ARN of the behavior graph to invite the member accounts to
#' contribute their data to.
#' @param Message Customized message text to include in the invitation email message to
#' the invited member accounts.
#' @param Accounts &#91;required&#93; The list of AWS accounts to invite to become member accounts in the
#' behavior graph. For each invited account, the account list contains the
#' account identifier and the AWS account root user email address.
#'
#' @return
#' A list with the following syntax:
#' ```
#' list(
#'   Members = list(
#'     list(
#'       AccountId = "string",
#'       EmailAddress = "string",
#'       GraphArn = "string",
#'       MasterId = "string",
#'       Status = "INVITED"|"VERIFICATION_IN_PROGRESS"|"VERIFICATION_FAILED"|"ENABLED"|"ACCEPTED_BUT_DISABLED",
#'       DisabledReason = "VOLUME_TOO_HIGH"|"VOLUME_UNKNOWN",
#'       InvitedTime = as.POSIXct(
#'         "2015-01-01"
#'       ),
#'       UpdatedTime = as.POSIXct(
#'         "2015-01-01"
#'       ),
#'       PercentOfGraphUtilization = 123.0,
#'       PercentOfGraphUtilizationUpdatedTime = as.POSIXct(
#'         "2015-01-01"
#'       )
#'     )
#'   ),
#'   UnprocessedAccounts = list(
#'     list(
#'       AccountId = "string",
#'       Reason = "string"
#'     )
#'   )
#' )
#' ```
#'
#' @section Request syntax:
#' ```
#' svc$create_members(
#'   GraphArn = "string",
#'   Message = "string",
#'   Accounts = list(
#'     list(
#'       AccountId = "string",
#'       EmailAddress = "string"
#'     )
#'   )
#' )
#' ```
#'
#' @keywords internal
#'
#' @rdname detective_create_members
detective_create_members <- function(GraphArn, Message = NULL, Accounts) {
  op <- new_operation(
    name = "CreateMembers",
    http_method = "POST",
    http_path = "/graph/members",
    paginator = list()
  )
  input <- .detective$create_members_input(GraphArn = GraphArn, Message = Message, Accounts = Accounts)
  output <- .detective$create_members_output()
  config <- get_config()
  svc <- .detective$service(config)
  request <- new_request(svc, op, input, output)
  response <- send_request(request)
  return(response)
}
.detective$operations$create_members <- detective_create_members

#' Disables the specified behavior graph and queues it to be deleted
#'
#' @description
#' Disables the specified behavior graph and queues it to be deleted. This
#' operation removes the graph from each member account's list of behavior
#' graphs.
#' 
#' [`delete_graph`][detective_delete_graph] can only be called by the
#' master account for a behavior graph.
#'
#' @usage
#' detective_delete_graph(GraphArn)
#'
#' @param GraphArn &#91;required&#93; The ARN of the behavior graph to disable.
#'
#' @return
#' An empty list.
#'
#' @section Request syntax:
#' ```
#' svc$delete_graph(
#'   GraphArn = "string"
#' )
#' ```
#'
#' @keywords internal
#'
#' @rdname detective_delete_graph
detective_delete_graph <- function(GraphArn) {
  op <- new_operation(
    name = "DeleteGraph",
    http_method = "POST",
    http_path = "/graph/removal",
    paginator = list()
  )
  input <- .detective$delete_graph_input(GraphArn = GraphArn)
  output <- .detective$delete_graph_output()
  config <- get_config()
  svc <- .detective$service(config)
  request <- new_request(svc, op, input, output)
  response <- send_request(request)
  return(response)
}
.detective$operations$delete_graph <- detective_delete_graph

#' Deletes one or more member accounts from the master account behavior
#' graph
#'
#' @description
#' Deletes one or more member accounts from the master account behavior
#' graph. This operation can only be called by a Detective master account.
#' That account cannot use [`delete_members`][detective_delete_members] to
#' delete their own account from the behavior graph. To disable a behavior
#' graph, the master account uses the
#' [`delete_graph`][detective_delete_graph] API method.
#'
#' @usage
#' detective_delete_members(GraphArn, AccountIds)
#'
#' @param GraphArn &#91;required&#93; The ARN of the behavior graph to delete members from.
#' @param AccountIds &#91;required&#93; The list of AWS account identifiers for the member accounts to delete
#' from the behavior graph.
#'
#' @return
#' A list with the following syntax:
#' ```
#' list(
#'   AccountIds = list(
#'     "string"
#'   ),
#'   UnprocessedAccounts = list(
#'     list(
#'       AccountId = "string",
#'       Reason = "string"
#'     )
#'   )
#' )
#' ```
#'
#' @section Request syntax:
#' ```
#' svc$delete_members(
#'   GraphArn = "string",
#'   AccountIds = list(
#'     "string"
#'   )
#' )
#' ```
#'
#' @keywords internal
#'
#' @rdname detective_delete_members
detective_delete_members <- function(GraphArn, AccountIds) {
  op <- new_operation(
    name = "DeleteMembers",
    http_method = "POST",
    http_path = "/graph/members/removal",
    paginator = list()
  )
  input <- .detective$delete_members_input(GraphArn = GraphArn, AccountIds = AccountIds)
  output <- .detective$delete_members_output()
  config <- get_config()
  svc <- .detective$service(config)
  request <- new_request(svc, op, input, output)
  response <- send_request(request)
  return(response)
}
.detective$operations$delete_members <- detective_delete_members

#' Removes the member account from the specified behavior graph
#'
#' @description
#' Removes the member account from the specified behavior graph. This
#' operation can only be called by a member account that has the `ENABLED`
#' status.
#'
#' @usage
#' detective_disassociate_membership(GraphArn)
#'
#' @param GraphArn &#91;required&#93; The ARN of the behavior graph to remove the member account from.
#' 
#' The member account's member status in the behavior graph must be
#' `ENABLED`.
#'
#' @return
#' An empty list.
#'
#' @section Request syntax:
#' ```
#' svc$disassociate_membership(
#'   GraphArn = "string"
#' )
#' ```
#'
#' @keywords internal
#'
#' @rdname detective_disassociate_membership
detective_disassociate_membership <- function(GraphArn) {
  op <- new_operation(
    name = "DisassociateMembership",
    http_method = "POST",
    http_path = "/membership/removal",
    paginator = list()
  )
  input <- .detective$disassociate_membership_input(GraphArn = GraphArn)
  output <- .detective$disassociate_membership_output()
  config <- get_config()
  svc <- .detective$service(config)
  request <- new_request(svc, op, input, output)
  response <- send_request(request)
  return(response)
}
.detective$operations$disassociate_membership <- detective_disassociate_membership

#' Returns the membership details for specified member accounts for a
#' behavior graph
#'
#' @description
#' Returns the membership details for specified member accounts for a
#' behavior graph.
#'
#' @usage
#' detective_get_members(GraphArn, AccountIds)
#'
#' @param GraphArn &#91;required&#93; The ARN of the behavior graph for which to request the member details.
#' @param AccountIds &#91;required&#93; The list of AWS account identifiers for the member account for which to
#' return member details.
#' 
#' You cannot use [`get_members`][detective_get_members] to retrieve
#' information about member accounts that were removed from the behavior
#' graph.
#'
#' @return
#' A list with the following syntax:
#' ```
#' list(
#'   MemberDetails = list(
#'     list(
#'       AccountId = "string",
#'       EmailAddress = "string",
#'       GraphArn = "string",
#'       MasterId = "string",
#'       Status = "INVITED"|"VERIFICATION_IN_PROGRESS"|"VERIFICATION_FAILED"|"ENABLED"|"ACCEPTED_BUT_DISABLED",
#'       DisabledReason = "VOLUME_TOO_HIGH"|"VOLUME_UNKNOWN",
#'       InvitedTime = as.POSIXct(
#'         "2015-01-01"
#'       ),
#'       UpdatedTime = as.POSIXct(
#'         "2015-01-01"
#'       ),
#'       PercentOfGraphUtilization = 123.0,
#'       PercentOfGraphUtilizationUpdatedTime = as.POSIXct(
#'         "2015-01-01"
#'       )
#'     )
#'   ),
#'   UnprocessedAccounts = list(
#'     list(
#'       AccountId = "string",
#'       Reason = "string"
#'     )
#'   )
#' )
#' ```
#'
#' @section Request syntax:
#' ```
#' svc$get_members(
#'   GraphArn = "string",
#'   AccountIds = list(
#'     "string"
#'   )
#' )
#' ```
#'
#' @keywords internal
#'
#' @rdname detective_get_members
detective_get_members <- function(GraphArn, AccountIds) {
  op <- new_operation(
    name = "GetMembers",
    http_method = "POST",
    http_path = "/graph/members/get",
    paginator = list()
  )
  input <- .detective$get_members_input(GraphArn = GraphArn, AccountIds = AccountIds)
  output <- .detective$get_members_output()
  config <- get_config()
  svc <- .detective$service(config)
  request <- new_request(svc, op, input, output)
  response <- send_request(request)
  return(response)
}
.detective$operations$get_members <- detective_get_members

#' Returns the list of behavior graphs that the calling account is a master
#' of
#'
#' @description
#' Returns the list of behavior graphs that the calling account is a master
#' of. This operation can only be called by a master account.
#' 
#' Because an account can currently only be the master of one behavior
#' graph within a Region, the results always contain a single graph.
#'
#' @usage
#' detective_list_graphs(NextToken, MaxResults)
#'
#' @param NextToken For requests to get the next page of results, the pagination token that
#' was returned with the previous set of results. The initial request does
#' not include a pagination token.
#' @param MaxResults The maximum number of graphs to return at a time. The total must be less
#' than the overall limit on the number of results to return, which is
#' currently 200.
#'
#' @return
#' A list with the following syntax:
#' ```
#' list(
#'   GraphList = list(
#'     list(
#'       Arn = "string",
#'       CreatedTime = as.POSIXct(
#'         "2015-01-01"
#'       )
#'     )
#'   ),
#'   NextToken = "string"
#' )
#' ```
#'
#' @section Request syntax:
#' ```
#' svc$list_graphs(
#'   NextToken = "string",
#'   MaxResults = 123
#' )
#' ```
#'
#' @keywords internal
#'
#' @rdname detective_list_graphs
detective_list_graphs <- function(NextToken = NULL, MaxResults = NULL) {
  op <- new_operation(
    name = "ListGraphs",
    http_method = "POST",
    http_path = "/graphs/list",
    paginator = list()
  )
  input <- .detective$list_graphs_input(NextToken = NextToken, MaxResults = MaxResults)
  output <- .detective$list_graphs_output()
  config <- get_config()
  svc <- .detective$service(config)
  request <- new_request(svc, op, input, output)
  response <- send_request(request)
  return(response)
}
.detective$operations$list_graphs <- detective_list_graphs

#' Retrieves the list of open and accepted behavior graph invitations for
#' the member account
#'
#' @description
#' Retrieves the list of open and accepted behavior graph invitations for
#' the member account. This operation can only be called by a member
#' account.
#' 
#' Open invitations are invitations that the member account has not
#' responded to.
#' 
#' The results do not include behavior graphs for which the member account
#' declined the invitation. The results also do not include behavior graphs
#' that the member account resigned from or was removed from.
#'
#' @usage
#' detective_list_invitations(NextToken, MaxResults)
#'
#' @param NextToken For requests to retrieve the next page of results, the pagination token
#' that was returned with the previous page of results. The initial request
#' does not include a pagination token.
#' @param MaxResults The maximum number of behavior graph invitations to return in the
#' response. The total must be less than the overall limit on the number of
#' results to return, which is currently 200.
#'
#' @return
#' A list with the following syntax:
#' ```
#' list(
#'   Invitations = list(
#'     list(
#'       AccountId = "string",
#'       EmailAddress = "string",
#'       GraphArn = "string",
#'       MasterId = "string",
#'       Status = "INVITED"|"VERIFICATION_IN_PROGRESS"|"VERIFICATION_FAILED"|"ENABLED"|"ACCEPTED_BUT_DISABLED",
#'       DisabledReason = "VOLUME_TOO_HIGH"|"VOLUME_UNKNOWN",
#'       InvitedTime = as.POSIXct(
#'         "2015-01-01"
#'       ),
#'       UpdatedTime = as.POSIXct(
#'         "2015-01-01"
#'       ),
#'       PercentOfGraphUtilization = 123.0,
#'       PercentOfGraphUtilizationUpdatedTime = as.POSIXct(
#'         "2015-01-01"
#'       )
#'     )
#'   ),
#'   NextToken = "string"
#' )
#' ```
#'
#' @section Request syntax:
#' ```
#' svc$list_invitations(
#'   NextToken = "string",
#'   MaxResults = 123
#' )
#' ```
#'
#' @keywords internal
#'
#' @rdname detective_list_invitations
detective_list_invitations <- function(NextToken = NULL, MaxResults = NULL) {
  op <- new_operation(
    name = "ListInvitations",
    http_method = "POST",
    http_path = "/invitations/list",
    paginator = list()
  )
  input <- .detective$list_invitations_input(NextToken = NextToken, MaxResults = MaxResults)
  output <- .detective$list_invitations_output()
  config <- get_config()
  svc <- .detective$service(config)
  request <- new_request(svc, op, input, output)
  response <- send_request(request)
  return(response)
}
.detective$operations$list_invitations <- detective_list_invitations

#' Retrieves the list of member accounts for a behavior graph
#'
#' @description
#' Retrieves the list of member accounts for a behavior graph. Does not
#' return member accounts that were removed from the behavior graph.
#'
#' @usage
#' detective_list_members(GraphArn, NextToken, MaxResults)
#'
#' @param GraphArn &#91;required&#93; The ARN of the behavior graph for which to retrieve the list of member
#' accounts.
#' @param NextToken For requests to retrieve the next page of member account results, the
#' pagination token that was returned with the previous page of results.
#' The initial request does not include a pagination token.
#' @param MaxResults The maximum number of member accounts to include in the response. The
#' total must be less than the overall limit on the number of results to
#' return, which is currently 200.
#'
#' @return
#' A list with the following syntax:
#' ```
#' list(
#'   MemberDetails = list(
#'     list(
#'       AccountId = "string",
#'       EmailAddress = "string",
#'       GraphArn = "string",
#'       MasterId = "string",
#'       Status = "INVITED"|"VERIFICATION_IN_PROGRESS"|"VERIFICATION_FAILED"|"ENABLED"|"ACCEPTED_BUT_DISABLED",
#'       DisabledReason = "VOLUME_TOO_HIGH"|"VOLUME_UNKNOWN",
#'       InvitedTime = as.POSIXct(
#'         "2015-01-01"
#'       ),
#'       UpdatedTime = as.POSIXct(
#'         "2015-01-01"
#'       ),
#'       PercentOfGraphUtilization = 123.0,
#'       PercentOfGraphUtilizationUpdatedTime = as.POSIXct(
#'         "2015-01-01"
#'       )
#'     )
#'   ),
#'   NextToken = "string"
#' )
#' ```
#'
#' @section Request syntax:
#' ```
#' svc$list_members(
#'   GraphArn = "string",
#'   NextToken = "string",
#'   MaxResults = 123
#' )
#' ```
#'
#' @keywords internal
#'
#' @rdname detective_list_members
detective_list_members <- function(GraphArn, NextToken = NULL, MaxResults = NULL) {
  op <- new_operation(
    name = "ListMembers",
    http_method = "POST",
    http_path = "/graph/members/list",
    paginator = list()
  )
  input <- .detective$list_members_input(GraphArn = GraphArn, NextToken = NextToken, MaxResults = MaxResults)
  output <- .detective$list_members_output()
  config <- get_config()
  svc <- .detective$service(config)
  request <- new_request(svc, op, input, output)
  response <- send_request(request)
  return(response)
}
.detective$operations$list_members <- detective_list_members

#' Rejects an invitation to contribute the account data to a behavior graph
#'
#' @description
#' Rejects an invitation to contribute the account data to a behavior
#' graph. This operation must be called by a member account that has the
#' `INVITED` status.
#'
#' @usage
#' detective_reject_invitation(GraphArn)
#'
#' @param GraphArn &#91;required&#93; The ARN of the behavior graph to reject the invitation to.
#' 
#' The member account's current member status in the behavior graph must be
#' `INVITED`.
#'
#' @return
#' An empty list.
#'
#' @section Request syntax:
#' ```
#' svc$reject_invitation(
#'   GraphArn = "string"
#' )
#' ```
#'
#' @keywords internal
#'
#' @rdname detective_reject_invitation
detective_reject_invitation <- function(GraphArn) {
  op <- new_operation(
    name = "RejectInvitation",
    http_method = "POST",
    http_path = "/invitation/removal",
    paginator = list()
  )
  input <- .detective$reject_invitation_input(GraphArn = GraphArn)
  output <- .detective$reject_invitation_output()
  config <- get_config()
  svc <- .detective$service(config)
  request <- new_request(svc, op, input, output)
  response <- send_request(request)
  return(response)
}
.detective$operations$reject_invitation <- detective_reject_invitation

#' Sends a request to enable data ingest for a member account that has a
#' status of ACCEPTED_BUT_DISABLED
#'
#' @description
#' Sends a request to enable data ingest for a member account that has a
#' status of `ACCEPTED_BUT_DISABLED`.
#' 
#' For valid member accounts, the status is updated as follows.
#' 
#' -   If Detective enabled the member account, then the new status is
#'     `ENABLED`.
#' 
#' -   If Detective cannot enable the member account, the status remains
#'     `ACCEPTED_BUT_DISABLED`.
#'
#' @usage
#' detective_start_monitoring_member(GraphArn, AccountId)
#'
#' @param GraphArn &#91;required&#93; The ARN of the behavior graph.
#' @param AccountId &#91;required&#93; The account ID of the member account to try to enable.
#' 
#' The account must be an invited member account with a status of
#' `ACCEPTED_BUT_DISABLED`.
#'
#' @return
#' An empty list.
#'
#' @section Request syntax:
#' ```
#' svc$start_monitoring_member(
#'   GraphArn = "string",
#'   AccountId = "string"
#' )
#' ```
#'
#' @keywords internal
#'
#' @rdname detective_start_monitoring_member
detective_start_monitoring_member <- function(GraphArn, AccountId) {
  op <- new_operation(
    name = "StartMonitoringMember",
    http_method = "POST",
    http_path = "/graph/member/monitoringstate",
    paginator = list()
  )
  input <- .detective$start_monitoring_member_input(GraphArn = GraphArn, AccountId = AccountId)
  output <- .detective$start_monitoring_member_output()
  config <- get_config()
  svc <- .detective$service(config)
  request <- new_request(svc, op, input, output)
  response <- send_request(request)
  return(response)
}
.detective$operations$start_monitoring_member <- detective_start_monitoring_member
